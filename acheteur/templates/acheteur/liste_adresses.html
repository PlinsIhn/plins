{% extends 'acheteur/base_acheteur.html' %}

{% block content %}
<div class="container">

    <a href="{% url 'profil_acheteur' %}" class="btn-retour">&#8592;</a>
  
    <br><br>

    <div class="d-flex justify-content-between align-items-center">
      <h2>Ny adiresiko</h2>
      <div class="d-flex align-items-center gap-2">
        <a href="{% url 'ajouter_adresse' %}" class="btn btn-primary">
          <i class="bi bi-plus-circle-fill"></i> Hampiditra
        </a>
      </div>
    </div>
 <br>
    {% if adresses %}
        <ul>
            {% for a in adresses %}
                <li>
                  <div class="d-flex justify-content-between align-items-center">
                    <!-- Nom de l'adresse -->
                    <strong>{{ a.nom_adresse|default:"Adiresiko" }}</strong>

                    <!-- Icônes à droite -->
                    <div class="d-flex align-items-center gap-2">
                      {% if not a.est_defaut %}
                        <!-- Bouton Supprimer -->
                        <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal{{ a.id }}">
                          <i class="bi bi-trash"></i>
                        </button>
                      {% endif %}

                      <!-- Bouton Modifier -->
                      <a href="{% url 'modifier_adresse' a.id %}" class="btn btn-outline-secondary btn-sm">
                        <i class="bi bi-pencil-square"></i>
                      </a>
                    </div>
                  </div>

                  <div style="font-size: 14px;">
                    <div>
                      {{ a.adresse.fokontany }} / {{ a.adresse.commune }} / {{ a.adresse.district }} / {{ a.adresse.region }}
                    </div>
                    
                    {% if a.precision_adresse %} 
                        <strong class="text-primary">Toromarika : </strong> {{ a.precision_adresse }}
                    {% else %}
                        <strong class="text-danger">Tsy misy toromarika </strong>
                    {% endif %}

                    {% if a.est_defaut %}
                    &nbsp;&nbsp;
                      <span style="font-size: 13px; color: rgb(255, 255, 255); font-weight: bold; border-radius: 10px; padding-bottom: 4px; padding-left: 10px; padding-right: 10px; background-color: rgb(60, 217, 60);">
                        miasa
                      </span>
                    {% endif %}

                  </div>
                </li>

                <hr>

                <!-- Modal de confirmation propre à cette adresse -->
                <div class="modal fade" id="confirmDeleteModal{{ a.id }}" tabindex="-1" aria-labelledby="confirmDeleteLabel{{ a.id }}" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <form method="post" action="{% url 'supprimer_adresse' pk=a.id %}">
                        {% csrf_token %}
                        <div class="modal-header">
                          <h5 class="modal-title" id="confirmDeleteLabel{{ a.id }}">Confirmer la suppression</h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                        </div>
                        <div class="modal-body">
                          Êtes-vous sûr de vouloir supprimer cette adresse ?
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                          <button type="submit" class="btn btn-danger">Supprimer</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
            {% endfor %}
        </ul>
    {% else %}
        <p>Vous n'avez encore ajouté aucune adresse.</p>
    {% endif %}

</div>

<style>
  .btn-retour {
      text-decoration: none; 
      color: black; 
      border: 1px solid gray;
      padding-left: 10px;
      padding-right: 10px;
      background-color: rgb(240, 250, 120);
      border-radius: 5px;
      transition: 0.4s;
  }
  .btn-retour:hover {
      background-color: white;
      transition: 0.4s;
  }
</style>
{% endblock %}
